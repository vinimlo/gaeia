---
interface Props {
  value: number;
  height?: number;
  showGlow?: boolean;
  color?: 'cyan' | 'amber' | 'violet' | 'green';
  animated?: boolean;
}

const {
  value,
  height = 8,
  showGlow = true,
  color = 'cyan',
  animated = true
} = Astro.props;

const colors = {
  cyan: {
    bg: 'bg-synapse-cyan',
    glow: 'shadow-glow-cyan'
  },
  amber: {
    bg: 'bg-axon-amber',
    glow: 'shadow-glow-amber'
  },
  violet: {
    bg: 'bg-dendrite-violet',
    glow: 'shadow-glow-violet'
  },
  green: {
    bg: 'bg-complete-pulse',
    glow: 'shadow-glow-green'
  }
};

const selectedColor = colors[color];
---

<div
  class="relative w-full bg-star-dust rounded-full overflow-hidden"
  style={`height: ${height}px;`}
  role="progressbar"
  aria-valuenow={value}
  aria-valuemin={0}
  aria-valuemax={100}
>
  <div
    class:list={[
      'h-full rounded-full transition-all duration-500 ease-out',
      selectedColor.bg,
      showGlow && value > 0 && selectedColor.glow,
      animated && 'animate-progress'
    ]}
    style={`width: ${value}%;`}
  >
    <!-- Shimmer effect -->
    {value > 0 && animated && (
      <div class="absolute inset-0 overflow-hidden rounded-full">
        <div class="shimmer-overlay" />
      </div>
    )}
  </div>
</div>

<style>
  @keyframes progress-grow {
    from {
      width: 0%;
    }
  }

  .animate-progress {
    animation: progress-grow 0.8s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .shimmer-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(
      90deg,
      transparent 0%,
      rgba(255, 255, 255, 0.2) 50%,
      transparent 100%
    );
    background-size: 200% 100%;
    animation: shimmer 2s linear infinite;
  }

  @keyframes shimmer {
    0% {
      background-position: 200% 0;
    }
    100% {
      background-position: -200% 0;
    }
  }
</style>
