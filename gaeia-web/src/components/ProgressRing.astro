---
interface Props {
  value: number;
  size?: number;
  strokeWidth?: number;
  showLabel?: boolean;
  color?: 'cyan' | 'amber' | 'violet' | 'green';
}

const {
  value,
  size = 80,
  strokeWidth = 6,
  showLabel = true,
  color = 'cyan'
} = Astro.props;

const radius = (size - strokeWidth) / 2;
const circumference = radius * 2 * Math.PI;
const offset = circumference - (value / 100) * circumference;

const colors = {
  cyan: {
    stroke: '#00d4ff',
    glow: 'rgba(0, 212, 255, 0.4)'
  },
  amber: {
    stroke: '#ffb020',
    glow: 'rgba(255, 176, 32, 0.4)'
  },
  violet: {
    stroke: '#a78bfa',
    glow: 'rgba(167, 139, 250, 0.4)'
  },
  green: {
    stroke: '#22c55e',
    glow: 'rgba(34, 197, 94, 0.4)'
  }
};

const selectedColor = colors[color];
---

<div class="relative inline-flex items-center justify-center" style={`width: ${size}px; height: ${size}px;`}>
  <svg
    class="progress-ring"
    width={size}
    height={size}
  >
    <!-- Background circle -->
    <circle
      class="text-star-dust"
      stroke="currentColor"
      stroke-width={strokeWidth}
      fill="transparent"
      r={radius}
      cx={size / 2}
      cy={size / 2}
    />
    <!-- Progress circle -->
    <circle
      class="progress-ring-circle"
      stroke={selectedColor.stroke}
      stroke-width={strokeWidth}
      stroke-linecap="round"
      fill="transparent"
      r={radius}
      cx={size / 2}
      cy={size / 2}
      style={`
        stroke-dasharray: ${circumference} ${circumference};
        stroke-dashoffset: ${offset};
        filter: drop-shadow(0 0 6px ${selectedColor.glow});
      `}
    />
  </svg>

  {showLabel && (
    <div class="absolute inset-0 flex items-center justify-center">
      <span class="text-bright font-display font-semibold" style={`font-size: ${size * 0.22}px;`}>
        {value}%
      </span>
    </div>
  )}
</div>

<style>
  .progress-ring {
    transform: rotate(-90deg);
  }

  .progress-ring-circle {
    transition: stroke-dashoffset 0.6s cubic-bezier(0.4, 0, 0.2, 1);
  }
</style>
